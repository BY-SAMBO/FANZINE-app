<!DOCTYPE html>
<html lang="es" style="scroll-behavior: smooth;">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fanzine Gold C3 - FANZINE Cine &amp; Tex-Mex</title>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --accent: #B8860B;
      --accent-light: #d4a843;
      --bg: #ffffff;
      --text: #000000;
      --text-muted: #555555;
      --surface: #ffffff;
      --border: #000000;
      --tag-salsa: #DC2626;
      --tag-queso: #FDE047;
      --tag-fresco: #2a9d8f;
      --tag-crunch: #ff9f1c;
      --tag-base: #8b5a2b;
      --tag-proteina: #c44536;
    }

    body {
      background: #fff;
      color: #000;
      font-family: 'Space Grotesk', sans-serif;
      line-height: 1.6;
    }

    h1, h2, h3 {
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* -- HERO -- */
    .hero {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 2rem;
      background: #fff;
    }

    .hero-badge {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: #000;
      background: var(--accent);
      border: 2px solid #000;
      padding: 4px 10px;
      margin-bottom: 1.5rem;
      display: inline-block;
    }

    .hero-emoji {
      font-size: 6rem;
      margin-bottom: 1.5rem;
      line-height: 1.2;
    }

    .hero h1 {
      font-size: clamp(3rem, 8vw, 6rem);
      color: var(--accent);
      line-height: 1;
    }

    .hero .subtitle {
      font-family: 'Space Grotesk', sans-serif;
      font-size: clamp(1.2rem, 3vw, 1.8rem);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--accent-light);
      margin-top: 0.5rem;
    }

    .hero .tagline {
      font-size: clamp(1rem, 3vw, 1.4rem);
      color: var(--text-muted);
      margin-top: 0.75rem;
      font-weight: 600;
    }

    .scroll-hint {
      margin-top: 3rem;
      color: var(--text-muted);
      font-size: 0.85rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* -- SECTIONS -- */
    section {
      max-width: 800px;
      margin: 0 auto;
      padding: 4rem 1.5rem;
    }

    .section-title {
      font-size: clamp(2rem, 5vw, 3rem);
      color: var(--accent);
      margin-bottom: 2rem;
      text-align: center;
    }

    /* -- RECETA TIMELINE -- */
    .recipe-timeline {
      position: relative;
      padding-left: 2rem;
    }

    .recipe-timeline::before {
      content: '';
      position: absolute;
      left: 0.75rem;
      top: 0;
      bottom: 0;
      width: 3px;
      background: #000;
    }

    .ingredient {
      position: relative;
      margin-bottom: 1.25rem;
      padding: 1.25rem 1.5rem;
      background: #fff;
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
    }

    .ingredient::before {
      content: '';
      position: absolute;
      left: -1.65rem;
      top: 50%;
      transform: translateY(-50%);
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 3px solid #000;
      background: var(--accent);
    }

    .ingredient-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-bottom: 0.35rem;
    }

    .ingredient-name {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1.15rem;
      font-weight: 700;
      text-transform: uppercase;
      color: #000;
    }

    .ingredient-tag {
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      padding: 2px 8px;
      border: 2px solid #000;
      color: #000;
    }

    .tag-base { background: var(--tag-base); }
    .tag-salsa { background: var(--tag-salsa); }
    .tag-queso { background: var(--tag-queso); }
    .tag-fresco { background: var(--tag-fresco); }
    .tag-crunch { background: var(--tag-crunch); }
    .tag-proteina { background: var(--tag-proteina); }

    .ingredient-role {
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .ingredient-detail {
      color: var(--text-muted);
      font-size: 0.8rem;
      font-style: italic;
      margin-top: 0.2rem;
    }

    .layer-number {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 0.8rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--accent);
      margin-bottom: 0.25rem;
    }

    /* -- STAR INGREDIENT HIGHLIGHT -- */
    .ingredient.star {
      border-left: 6px solid var(--accent);
      box-shadow: 4px 4px 0 var(--accent);
    }

    .ingredient.star .ingredient-name::after {
      content: ' \2605';
      color: var(--accent);
    }

    /* -- QUANTITY INPUT -- */
    .ingredient-qty { margin-top: 0.5rem; }
    .qty-input {
      background: #fff;
      border: 2px solid #000;
      padding: 0.5rem 0.75rem;
      color: #000;
      font-size: 0.85rem;
      width: 100%;
      font-family: 'Space Grotesk', sans-serif;
    }
    .qty-input:focus { outline: none; border-color: var(--accent); }
    .qty-input::placeholder { color: #999; }

    /* -- CONSTRUCTION DIAGRAM -- */
    .construction {
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
      padding: 2rem;
    }

    .construction-step {
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      padding: 0.75rem 0;
    }

    .construction-step + .construction-step {
      border-top: 2px solid #eee;
    }

    .step-number {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 0.75rem;
      font-weight: 700;
      color: #fff;
      background: var(--accent);
      border: 2px solid #000;
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .step-text {
      font-size: 0.95rem;
      color: #000;
      line-height: 1.5;
    }

    .step-text strong {
      text-transform: uppercase;
      font-size: 0.85rem;
      letter-spacing: 0.05em;
    }

    /* -- PALATABILITY -- */
    .meters {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    .meter-row {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .meter-label {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      text-transform: uppercase;
      min-width: 120px;
      color: #000;
    }

    .meter-bar-bg {
      flex: 1;
      height: 16px;
      background: #f5f5f5;
      border: 2px solid #000;
      overflow: hidden;
    }

    .meter-bar-fill {
      height: 100%;
      background: var(--accent);
    }

    .meter-value {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      color: var(--accent);
      min-width: 30px;
      text-align: right;
    }

    /* -- PERFIL DE SABOR -- */
    .flavor-card {
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
      padding: 2rem;
    }

    .flavor-text {
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--text-muted);
      text-align: center;
      max-width: 650px;
      margin: 0 auto;
      font-style: italic;
    }

    .flavor-text::before,
    .flavor-text::after {
      content: '\201C';
      color: var(--accent);
      font-size: 2rem;
      font-family: 'Space Grotesk', sans-serif;
      font-weight: 700;
      vertical-align: -0.2em;
    }
    .flavor-text::after {
      content: '\201D';
    }

    /* -- NOTAS DEL LAB -- */
    .lab-notes-card {
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
      padding: 1.5rem;
    }

    .lab-notes-area {
      width: 100%;
      min-height: 120px;
      background: #fff;
      border: 2px solid #000;
      padding: 0.5rem 0.75rem;
      color: #000;
      font-size: 0.95rem;
      font-family: 'Space Grotesk', sans-serif;
      line-height: 1.6;
      resize: vertical;
    }
    .lab-notes-area:focus { outline: none; border-color: var(--accent); }
    .lab-notes-area::placeholder { color: #999; }

    /* -- TAREAS -- */
    .tareas-list {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .tarea-item {
      padding: 0.75rem 1rem;
      background: #f9f9f9;
      border-left: 4px solid var(--accent);
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .tarea-icon {
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .tarea-text {
      font-size: 1rem;
      color: #000;
    }

    /* -- EVOLUTION CARD -- */
    .evolution-card {
      border: 3px solid #000;
      box-shadow: 4px 4px 0 #000;
      padding: 1.5rem;
    }

    .evolution-label {
      font-size: 0.7rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      margin-bottom: 0.75rem;
    }

    .evolution-change {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.5rem 0;
    }

    .evolution-change + .evolution-change {
      border-top: 1px solid #eee;
    }

    .change-icon {
      font-size: 1rem;
      flex-shrink: 0;
      margin-top: 0.1rem;
    }

    .change-text {
      font-size: 0.9rem;
      color: #000;
      line-height: 1.5;
    }

    /* -- FOOTER -- */
    footer {
      text-align: center;
      padding: 2rem 1.5rem;
      border-top: 3px solid #000;
    }

    footer .brand {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1.6rem;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--accent);
      letter-spacing: 0.1em;
    }

    footer .sub {
      color: var(--text-muted);
      font-size: 0.85rem;
      margin-top: 0.25rem;
    }

    footer .footer-links {
      margin-top: 1rem;
      display: flex;
      justify-content: center;
      gap: 2rem;
    }

    footer a {
      color: #000;
      text-decoration: none;
      font-weight: 700;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    footer a:hover { color: var(--accent); }

    /* -- RESPONSIVE -- */
    @media (max-width: 600px) {
      .hero-emoji { font-size: 4rem; }
      section { padding: 3rem 1rem; }
      .meter-label { min-width: 90px; font-size: 0.9rem; }
      .ingredient { padding: 1rem; }
    }
  </style>
</head>
<body>

  <!-- HERO -->
  <div class="hero">
    <div class="hero-badge">CICLO 3 &mdash; ACOTACI&Oacute;N</div>
    <div class="hero-emoji">&#10024;&#127789;&#129351;</div>
    <h1>FANZINE GOLD</h1>
    <div class="subtitle">Seattle Style</div>
    <p class="tagline">Queso crema, Carolina Gold, pepinillos, crocante estructural.</p>
    <div class="scroll-hint">&#8595; Descubre la receta</div>
  </div>

  <!-- LA RECETA -->
  <section>
    <h2 class="section-title">LA RECETA</h2>
    <div class="recipe-timeline">

      <div class="ingredient">
        <div class="layer-number">Paso 08 &mdash; Drizzle Final</div>
        <div class="ingredient-header">
          <span class="ingredient-name">Drizzle Salsa Gold</span>
          <span class="ingredient-tag tag-salsa">salsa</span>
        </div>
        <div class="ingredient-role">Solo Gold &mdash; drizzle que se extiende hasta el pan</div>
        <div class="ingredient-detail">Cierre visual y de sabor, cubre toppings y llega a los bordes del pan</div>
        <div class="ingredient-qty">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-drizzle" placeholder="Notas..." />
        </div>
      </div>

      <div class="ingredient" style="border: 3px dashed #000; box-shadow: 4px 4px 0 #2a9d8f;">
        <div class="layer-number">Paso 07 &mdash; Fresco <span style="background:#2a9d8f;color:#fff;font-size:9px;padding:2px 6px;border:2px solid #000;margin-left:6px;letter-spacing:0.1em;">A ELEGIR</span></div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:0.75rem;margin-top:0.75rem;">
          <div style="border:2px solid #000;padding:0.75rem;text-align:center;">
            <div style="font-size:1.5rem;margin-bottom:0.25rem;">&#129362;</div>
            <div style="font-size:0.8rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;">Pepinillos</div>
            <div style="font-size:0.7rem;color:#555;margin-top:0.25rem;">Acidez suave, reinicio de paladar</div>
          </div>
          <div style="border:2px solid #000;padding:0.75rem;text-align:center;">
            <div style="font-size:1.5rem;margin-bottom:0.25rem;">&#127798;&#65039;</div>
            <div style="font-size:0.8rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;">Jalape&ntilde;os</div>
            <div style="font-size:0.7rem;color:#555;margin-top:0.25rem;">Frescura con picante</div>
          </div>
          <div style="border:2px solid #000;padding:0.75rem;text-align:center;">
            <div style="font-size:1.5rem;margin-bottom:0.25rem;">&#127821;</div>
            <div style="font-size:0.8rem;font-weight:700;text-transform:uppercase;letter-spacing:0.05em;">Pi&ntilde;a</div>
            <div style="font-size:0.7rem;color:#555;margin-top:0.25rem;">Dulzura tropical que contrasta</div>
          </div>
        </div>
        <div class="ingredient-qty" style="margin-top:0.75rem;">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-fresco" placeholder="Cual se usa, notas..." />
        </div>
      </div>

      <div class="ingredient">
        <div class="layer-number">Paso 06</div>
        <div class="ingredient-header">
          <span class="ingredient-name">Cebolla Crispy + Tocineta Picada</span>
          <span class="ingredient-tag tag-crunch">crunch</span>
          <span class="ingredient-tag tag-base">base</span>
        </div>
        <div class="ingredient-role">Crocancia y umami encima de la salchicha glaseada</div>
        <div class="ingredient-detail">Tocineta picada (no envuelta), se pone junto con la cebolla crispy</div>
        <div class="ingredient-qty">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-cebolla-tocineta" placeholder="Notas..." />
        </div>
      </div>

      <div class="ingredient star">
        <div class="layer-number">Paso 05 &mdash; Glaseado</div>
        <div class="ingredient-header">
          <span class="ingredient-name">Salsa Gold + Le&ntilde;a</span>
          <span class="ingredient-tag tag-salsa">salsa</span>
        </div>
        <div class="ingredient-role">Glasear la salchicha ya montada con ambas salsas</div>
        <div class="ingredient-detail">Primer pase: Gold + le&ntilde;a directo sobre la salchicha en el pan</div>
        <div class="ingredient-qty">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-glaseado" placeholder="Notas..." />
        </div>
      </div>

      <div class="ingredient">
        <div class="layer-number">Paso 04 &mdash; Proteina</div>
        <div class="ingredient-header">
          <span class="ingredient-name">Salchicha</span>
          <span class="ingredient-tag tag-base">base</span>
        </div>
        <div class="ingredient-role">Se monta sobre el crocante y el queso, sin glasear</div>
        <div class="ingredient-qty">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-salchicha" placeholder="Notas..." />
        </div>
      </div>

      <div class="ingredient star">
        <div class="layer-number">Paso 03 &mdash; Queso</div>
        <div class="ingredient-header">
          <span class="ingredient-name">Queso Crema</span>
          <span class="ingredient-tag tag-queso">queso</span>
        </div>
        <div class="ingredient-role">~50g esparcido con cuchillo, de la mitad del pan para arriba</div>
        <div class="ingredient-detail">Visible al abrir &mdash; no queda oculto bajo la salchicha</div>
        <div class="ingredient-qty">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-queso-crema" placeholder="Notas..." />
        </div>
      </div>

      <div class="ingredient">
        <div class="layer-number">Paso 02 &mdash; Estructura</div>
        <div class="ingredient-header">
          <span class="ingredient-name">Crocante Base</span>
          <span class="ingredient-tag tag-crunch">crunch</span>
        </div>
        <div class="ingredient-role">Cama estructural debajo de la salchicha &mdash; eleva y da percepci&oacute;n de volumen</div>
        <div class="ingredient-detail">Elemento est&aacute;ndar para todos los perros del C3</div>
        <div class="ingredient-qty">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-crocante-base" placeholder="Tipo de crocante, notas..." />
        </div>
      </div>

      <div class="ingredient">
        <div class="layer-number">Paso 01 &mdash; Base</div>
        <div class="ingredient-header">
          <span class="ingredient-name">Pan Brioche</span>
          <span class="ingredient-tag tag-base">base</span>
        </div>
        <div class="ingredient-role">El fundamento</div>
        <div class="ingredient-qty">
          <input type="text" class="qty-input" data-key="c3-fanzine-gold-pan" placeholder="Notas..." />
        </div>
      </div>

    </div>
  </section>

  <!-- CONSTRUCCION -->
  <section>
    <h2 class="section-title">CONSTRUCCI&Oacute;N</h2>
    <div class="construction">
      <div class="construction-step">
        <div class="step-number">1</div>
        <div class="step-text"><strong>Pan brioche</strong> abierto</div>
      </div>
      <div class="construction-step">
        <div class="step-number">2</div>
        <div class="step-text"><strong>Crocante base</strong> como cama en el fondo del pan</div>
      </div>
      <div class="construction-step">
        <div class="step-number">3</div>
        <div class="step-text"><strong>Queso crema ~50g</strong> esparcido con cuchillo de la mitad del pan para arriba (que se vea)</div>
      </div>
      <div class="construction-step">
        <div class="step-number">4</div>
        <div class="step-text"><strong>Salchicha</strong> se monta sin glasear sobre el crocante y el queso</div>
      </div>
      <div class="construction-step">
        <div class="step-number">5</div>
        <div class="step-text"><strong>Glasear con Gold + le&ntilde;a</strong> &mdash; primer pase directo sobre la salchicha ya montada</div>
      </div>
      <div class="construction-step">
        <div class="step-number">6</div>
        <div class="step-text"><strong>Cebolla crispy + tocineta picada</strong> encima de la salchicha glaseada</div>
      </div>
      <div class="construction-step">
        <div class="step-number">7</div>
        <div class="step-text"><strong>Fresco a elegir:</strong> pepinillos, jalape&ntilde;os o pi&ntilde;a</div>
      </div>
      <div class="construction-step">
        <div class="step-number">8</div>
        <div class="step-text"><strong>Drizzle solo Gold</strong> &mdash; pase final que se extiende hasta el pan</div>
      </div>
    </div>
  </section>

  <!-- POR QUE FUNCIONA -->
  <section>
    <h2 class="section-title">POR QU&Eacute; FUNCIONA</h2>
    <div class="meters">
      <div class="meter-row">
        <span class="meter-label">Umami</span>
        <div class="meter-bar-bg"><div class="meter-bar-fill" style="width:80%"></div></div>
        <span class="meter-value">4/5</span>
      </div>
      <div class="meter-row">
        <span class="meter-label">Crunch</span>
        <div class="meter-bar-bg"><div class="meter-bar-fill" style="width:80%"></div></div>
        <span class="meter-value">4/5</span>
      </div>
      <div class="meter-row">
        <span class="meter-label">Cremosidad</span>
        <div class="meter-bar-bg"><div class="meter-bar-fill" style="width:80%"></div></div>
        <span class="meter-value">4/5</span>
      </div>
      <div class="meter-row">
        <span class="meter-label">Frescura</span>
        <div class="meter-bar-bg"><div class="meter-bar-fill" style="width:60%"></div></div>
        <span class="meter-value">3/5</span>
      </div>
      <div class="meter-row">
        <span class="meter-label">Picante</span>
        <div class="meter-bar-bg"><div class="meter-bar-fill" style="width:20%"></div></div>
        <span class="meter-value">1/5</span>
      </div>
    </div>
  </section>

  <!-- PERFIL DE SABOR -->
  <section>
    <h2 class="section-title">PERFIL DE SABOR</h2>
    <div class="flavor-card">
      <p class="flavor-text">Inspirado en el Seattle hot dog. La salchicha se monta y se glasea con Gold + le&ntilde;a directo en el pan. Cebolla crispy, tocineta picada y pepinillos van encima. Un drizzle final solo de Gold se extiende hasta el pan. El queso crema visible de la mitad para arriba crea la base cremosa. El crocante estructural debajo eleva todo y da percepci&oacute;n de volumen.</p>
    </div>
  </section>

  <!-- EVOLUCION DESDE C2 -->
  <section>
    <h2 class="section-title">EVOLUCI&Oacute;N DESDE C2</h2>
    <div class="evolution-card">
      <div class="evolution-label">Cambios respecto al Ciclo 2</div>
      <div class="evolution-change">
        <span class="change-icon">+</span>
        <span class="change-text"><strong>Pepinillos picados</strong> &mdash; resuelve la falta de frescura detectada en C2</span>
      </div>
      <div class="evolution-change">
        <span class="change-icon">+</span>
        <span class="change-text"><strong>Crocante base estructural</strong> &mdash; cama debajo de la salchicha (est&aacute;ndar C3)</span>
      </div>
      <div class="evolution-change">
        <span class="change-icon">&#8593;</span>
        <span class="change-text"><strong>Queso crema sube a ~50g</strong> &mdash; antes 27g era insuficiente. Se esparce de la mitad para arriba</span>
      </div>
      <div class="evolution-change">
        <span class="change-icon">&#8635;</span>
        <span class="change-text"><strong>Tocineta picada</strong> en vez de envuelta en la salchicha</span>
      </div>
      <div class="evolution-change">
        <span class="change-icon">&#8635;</span>
        <span class="change-text"><strong>Glaseado en ensamble</strong> &mdash; salchicha se monta sin glasear, Gold + le&ntilde;a se aplican encima ya montada</span>
      </div>
      <div class="evolution-change">
        <span class="change-icon">+</span>
        <span class="change-text"><strong>Drizzle final solo Gold</strong> &mdash; pase final que se extiende hasta el pan</span>
      </div>
      <div class="evolution-change">
        <span class="change-icon">+</span>
        <span class="change-text"><strong>Salsa le&ntilde;a vuelve</strong> &mdash; C2 la elimin&oacute;, C3 la reintegra junto con Gold en el glaseado</span>
      </div>
    </div>
  </section>

  <!-- NOTAS DEL LAB -->
  <section>
    <h2 class="section-title">NOTAS DEL LAB</h2>
    <div class="lab-notes-card">
      <textarea class="lab-notes-area" id="labNotes" data-key="c3-fanzine-gold-lab-notes" placeholder="Escribe tus notas de laboratorio aqu&iacute;..."></textarea>
    </div>
  </section>

  <!-- TAREAS -->
  <section>
    <h2 class="section-title">TAREAS</h2>
    <ul class="tareas-list">
      <li class="tarea-item">
        <span class="tarea-icon">&#9744;</span>
        <span class="tarea-text">Definir tipo de crocante base (papas fosforito, otro?)</span>
      </li>
      <li class="tarea-item">
        <span class="tarea-icon">&#9744;</span>
        <span class="tarea-text">Validar proporci&oacute;n de queso crema a 50g</span>
      </li>
      <li class="tarea-item">
        <span class="tarea-icon">&#9744;</span>
        <span class="tarea-text">Probar con doble glaseado Gold + le&ntilde;a</span>
      </li>
      <li class="tarea-item">
        <span class="tarea-icon">&#9744;</span>
        <span class="tarea-text">Definir nombre final</span>
      </li>
    </ul>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="brand">FANZINE</div>
    <div class="sub">Cine &amp; Tex-Mex &bull; Bogot&aacute;, Colombia</div>
    <div class="footer-links">
      <a href="/lab/perros-calientes/reconstruccion/ciclo-3" target="_top">&larr; Ciclo 3</a>
      <a href="/lab/perros-calientes/reconstruccion/ciclo-3" target="_top">LAB Gastron&oacute;mico &rarr;</a>
    </div>
  </footer>

  <script>
    (function() {
      var slug = location.pathname.replace(/.*\//, '').replace('.html', '');
      var debounceTimer;

      function collectData() {
        var d = {};
        document.querySelectorAll('.qty-input').forEach(function(input) {
          if (input.value) d['qty-' + input.dataset.key] = input.value;
        });
        var notesEl = document.getElementById('labNotes') || document.querySelector('.lab-notes');
        if (notesEl && notesEl.value) d['lab-notes'] = notesEl.value;
        // Collect editable fields for chat persistence
        var h1 = document.querySelector('h1');
        if (h1) d['recipe-name'] = h1.textContent.trim();
        var sub = document.querySelector('.subtitle');
        if (sub) d['recipe-subtitle'] = sub.textContent.trim();
        var fp = document.querySelector('.flavor-text');
        if (fp) d['flavor-profile'] = fp.textContent.trim();
        document.querySelectorAll('.ingredient').forEach(function(el, i) {
          var nameEl = el.querySelector('.ingredient-name');
          var roleEl = el.querySelector('.ingredient-role');
          if (nameEl) d['ing-name-' + i] = nameEl.textContent.trim();
          if (roleEl) d['ing-role-' + i] = roleEl.textContent.trim();
        });
        document.querySelectorAll('.meter-row').forEach(function(row) {
          var label = row.querySelector('.meter-label');
          var valEl = row.querySelector('.meter-value');
          if (label && valEl) d['meter-' + label.textContent.trim().toLowerCase()] = valEl.textContent.trim();
        });
        return d;
      }

      function applyData(d) {
        if (!d) return;
        document.querySelectorAll('.qty-input').forEach(function(input) {
          var val = d['qty-' + input.dataset.key];
          if (val) input.value = val;
        });
        var notesEl = document.getElementById('labNotes') || document.querySelector('.lab-notes');
        if (notesEl && d['lab-notes']) notesEl.value = d['lab-notes'];
        // Restore chat-edited fields
        if (d['recipe-name']) { var h1 = document.querySelector('h1'); if (h1) h1.textContent = d['recipe-name']; }
        if (d['recipe-subtitle']) { var sub = document.querySelector('.subtitle'); if (sub) sub.textContent = d['recipe-subtitle']; }
        if (d['flavor-profile']) { var fp = document.querySelector('.flavor-text'); if (fp) fp.textContent = d['flavor-profile']; }
        document.querySelectorAll('.ingredient').forEach(function(el, i) {
          var nameEl = el.querySelector('.ingredient-name');
          var roleEl = el.querySelector('.ingredient-role');
          if (nameEl && d['ing-name-' + i]) nameEl.textContent = d['ing-name-' + i];
          if (roleEl && d['ing-role-' + i]) roleEl.textContent = d['ing-role-' + i];
        });
        document.querySelectorAll('.meter-row').forEach(function(row) {
          var label = row.querySelector('.meter-label');
          if (!label) return;
          var key = 'meter-' + label.textContent.trim().toLowerCase();
          if (d[key]) {
            var parts = d[key].split('/');
            var val = parseInt(parts[0]) || 1;
            var pct = (val / 5) * 100;
            var fill = row.querySelector('.meter-bar-fill');
            var valEl = row.querySelector('.meter-value');
            if (fill) fill.style.width = pct + '%';
            if (valEl) valEl.textContent = d[key];
          }
        });
      }

      function save() {
        var d = collectData();
        localStorage.setItem('lab-recipe-' + slug, JSON.stringify(d));
        clearTimeout(debounceTimer);
        debounceTimer = setTimeout(function() {
          fetch('/api/lab/notes', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ slug: slug, data: d })
          }).catch(function() {});
        }, 1500);
      }

      // Apply localStorage immediately to prevent flash
      var localImmediate = localStorage.getItem('lab-recipe-' + slug);
      if (localImmediate) { try { applyData(JSON.parse(localImmediate)); } catch(e) {} }

      fetch('/api/lab/notes?slug=' + slug)
        .then(function(r) { return r.json(); })
        .then(function(res) {
          if (res.data && Object.keys(res.data).length > 0) {
            applyData(res.data);
            localStorage.setItem('lab-recipe-' + slug, JSON.stringify(res.data));
          }
        })
        .catch(function() {});

      document.querySelectorAll('.qty-input').forEach(function(input) {
        input.addEventListener('input', save);
      });
      var notesEl = document.getElementById('labNotes') || document.querySelector('.lab-notes');
      if (notesEl) notesEl.addEventListener('input', save);

      // Apply-edit handler for Lab Chat Editor
      window.addEventListener('message', function(e) {
        if (e.data && e.data.type === 'apply-edit') {
          var tool = e.data.tool;
          var args = e.data.args || {};
          switch (tool) {
            case 'updateRecipeName': {
              var h1 = document.querySelector('h1');
              if (h1) h1.textContent = args.newName;
              break;
            }
            case 'updateSubtitle': {
              var sub = document.querySelector('.subtitle');
              if (sub) sub.textContent = args.newSubtitle;
              break;
            }
            case 'updateIngredientName': {
              var found = false;
              document.querySelectorAll('.ingredient-name').forEach(function(el) {
                if (!found && el.textContent.trim().toLowerCase() === (args.currentName || '').toLowerCase()) {
                  el.textContent = args.newName;
                  found = true;
                }
              });
              break;
            }
            case 'updateIngredientRole': {
              var foundRole = false;
              document.querySelectorAll('.ingredient').forEach(function(el) {
                if (foundRole) return;
                var nameEl = el.querySelector('.ingredient-name');
                if (nameEl && nameEl.textContent.trim().toLowerCase() === (args.ingredientName || '').toLowerCase()) {
                  var roleEl = el.querySelector('.ingredient-role');
                  if (roleEl) { roleEl.textContent = args.newRole; foundRole = true; }
                }
              });
              break;
            }
            case 'updateMeter': {
              document.querySelectorAll('.meter-row').forEach(function(row) {
                var label = row.querySelector('.meter-label');
                if (label && label.textContent.trim().toLowerCase() === (args.meterName || '').toLowerCase()) {
                  var val = Math.max(1, Math.min(5, parseInt(args.value) || 1));
                  var pct = (val / 5) * 100;
                  var fill = row.querySelector('.meter-bar-fill');
                  var valEl = row.querySelector('.meter-value');
                  if (fill) fill.style.width = pct + '%';
                  if (valEl) valEl.textContent = val + '/5';
                }
              });
              break;
            }
            case 'updateFlavorProfile': {
              var fp = document.querySelector('.flavor-text');
              if (fp) fp.textContent = args.newText;
              break;
            }
            case 'updateLabNotes': {
              var notes = document.getElementById('labNotes') || document.querySelector('.lab-notes');
              if (notes) { notes.value = args.notes; notes.dispatchEvent(new Event('input')); }
              break;
            }
            case 'updateIngredientNotes': {
              var foundNotes = false;
              document.querySelectorAll('.ingredient').forEach(function(el) {
                if (foundNotes) return;
                var nameEl = el.querySelector('.ingredient-name');
                if (nameEl && nameEl.textContent.trim().toLowerCase() === (args.ingredientName || '').toLowerCase()) {
                  var inp = el.querySelector('.qty-input');
                  if (inp) { inp.value = args.notes; inp.dispatchEvent(new Event('input')); foundNotes = true; }
                }
              });
              break;
            }
          }
          save();
        }
      });

      // PostMessage context bridge for Lab Chat
      window.addEventListener('message', function(e) {
        if (e.data && e.data.type === 'get-recipe-context') {
          var name = document.querySelector('h1') ? document.querySelector('h1').textContent.trim() : '';
          var ingredients = [];
          document.querySelectorAll('.ingredient').forEach(function(el) {
            var n = el.querySelector('.ingredient-name');
            var t = el.querySelector('.ingredient-tag');
            var r = el.querySelector('.ingredient-role');
            var d = el.querySelector('.ingredient-detail');
            var q = el.querySelector('.qty-input');
            var line = (n?n.textContent.trim():'') + ' [' + (t?t.textContent.trim():'') + '] — ' + (r?r.textContent.trim():'');
            if (d) line += ' (' + d.textContent.trim() + ')';
            if (q && q.value) line += ' {notas: ' + q.value + '}';
            ingredients.push(line);
          });
          var construction = [];
          document.querySelectorAll('.step-text').forEach(function(el) { construction.push(el.textContent.trim()); });
          var meters = [];
          document.querySelectorAll('.meter-row').forEach(function(el) {
            var l = el.querySelector('.meter-label');
            var v = el.querySelector('.meter-value');
            meters.push((l?l.textContent.trim():'') + ': ' + (v?v.textContent.trim():''));
          });
          var flavor = document.querySelector('.flavor-text') ? document.querySelector('.flavor-text').textContent.trim() : '';
          var changes = [];
          document.querySelectorAll('.change-text').forEach(function(el) { changes.push(el.textContent.trim()); });
          var tasks = [];
          document.querySelectorAll('.tarea-text').forEach(function(el) { tasks.push(el.textContent.trim()); });
          var notes = '';
          var ne = document.getElementById('labNotes') || document.querySelector('.lab-notes');
          if (ne) notes = ne.value || '';
          var ctx = 'RECETA: ' + name + ' (Ciclo 3 — Acotacion)\n\nINGREDIENTES:\n' + ingredients.join('\n');
          if (construction.length) ctx += '\n\nCONSTRUCCION:\n' + construction.join('\n');
          ctx += '\n\nMETERS:\n' + meters.join('\n') + '\n\nPERFIL DE SABOR:\n' + flavor;
          if (changes.length) ctx += '\n\nCAMBIOS DESDE C2:\n' + changes.join('\n');
          if (tasks.length) ctx += '\n\nTAREAS:\n' + tasks.join('\n');
          if (notes) ctx += '\n\nNOTAS DEL LAB:\n' + notes;
          parent.postMessage({ type: 'recipe-context', context: ctx }, '*');
        }
      });
    })();
  </script>

</body>
</html>
